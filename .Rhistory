Rhombres
View(data)
View(data2)
log(15832670/15610217,exp(1))
ln(15832670/15610217,exp(1))
log(15832670/15610217
log(15832670/15610217)
Rhombres <- log(data2$Hombres[2:length(data2$Hombres)]/ data2$Hombres[1:length(data2$Hombres)-1])
Rhombres
Rhombres <- data2$Hombres[2:length(data2$Hombres)]/ data2$Hombres[1:length(data2$Hombres)-1]
Rhombres
log(1.20780)
log(Rhombres)
15507695/15192004
log(15507695/15192004)
Rmujeres <- log(data2$Mujeres[2:length(data2$Mujeres)]/ data2$Mujeres[1:length(data2$Mujeres)-1])
Rmujeres
Rhombres
rbind(c(0),Rhombres)
cbind(c(0),Rhombres)
rbind(c(0),Rhombres)
c(0,Rhombres)
c(Rhombres,1)
cbind(c(Rhombres,1),cbind(Rmujeres,1)
)
cbind(c(Rhombres,1),c(Rmujeres,1))
data %>% spread(Grupo, Total, fill = NA, convert = FALSE)
ata %>% spread(Grupo, Total, fill = NA, convert = FALSE) %>% mutate(tasa_hombres = c(log(Hombres[2:length(Hombres)]/Hombres[1:length(Hombres)-1]),1))
data %>% spread(Grupo, Total, fill = NA, convert = FALSE) %>% mutate(tasa_hombres = c(log(Hombres[2:length(Hombres)]/Hombres[1:length(Hombres)-1]),1))
data
data %>% spread(Grupo, Total, fill = NA, convert = FALSE) %>% mutate(tasa_hombres = c(log(Hombres[2:length(Hombres)]/Hombres[1:length(Hombres)-1]),1)) -> data2
data2
data %>% spread(Grupo, Total, fill = NA, convert = FALSE) %>% mutate(tasa_hombres = c(log(Hombres[2:length(Hombres)]/Hombres[1:length(Hombres)-1]),1))%>% mutate(tasa_mujeres = c(log(Mujeres[2:length(Mujeres)]/Mujees[1:length(Mujeres)-1]),1))  -> data2
data %>% spread(Grupo, Total, fill = NA, convert = FALSE) %>% mutate(tasa_hombres = c(log(Hombres[2:length(Hombres)]/Hombres[1:length(Hombres)-1]),1))%>% mutate(tasa_mujeres = c(log(Mujeres[2:length(Mujeres)]/Mujeres[1:length(Mujeres)-1]),1))  -> data2
data2
data %>% spread(Grupo, Total, fill = NA, convert = FALSE) %>% mutate(tasa_hombres = c(log(Hombres[2:length(Hombres)]/Hombres[1:length(Hombres)-1]),1))%>% mutate(tasa_mujeres = c(log(Mujeres[2:length(Mujeres)]/Mujeres[1:length(Mujeres)-1]),1))%>% mutate(Fecha=as.Date(paste("01","06",Año,sep="/"),"%d/%m/%Y"))   -> data2
data2
head(data)
head(data2)
data %>% spread(Grupo, Total, fill = NA, convert = FALSE) %>% mutate(tasa_hombres = c(log(Hombres[2:length(Hombres)]/Hombres[1:length(Hombres)-1]),1))%>% mutate(tasa_mujeres = c(log(Mujeres[2:length(Mujeres)]/Mujeres[1:length(Mujeres)-1]),1))%>% mutate(Fecha=as.Date(paste("01","06",Año,sep="/"),"%d/%m/%Y"))   -> data2
data2
pob_nal_est %>% filter(Fecha >= as.Date("1991/01/01"),Fecha <= as.Date("2015/09/01")) -> pob_nal_est_91
prob_condena <- 0.7
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2: cars
summary(cars)
# Chunk 3: pressure
plot(pressure)
# Chunk 4: librerías
library("magrittr")
library("dplyr")
library("tidyr")
library("ggplot2")
library("plotly")
library("zoo")
# Chunk 5: Estimación Población Nacional
setwd("/home/sergio/Prisiones/Data")
data = read.csv("POB_NAL_DANE.csv",header = TRUE,sep = ",",stringsAsFactors=FALSE)
# Graficar proyección de población
data %>% ggplot()+geom_line(aes(x=Año,y=Total, col = Grupo)) + ylim(0,27000000) -> grafica1
ggplotly(grafica1)
# reordenar columnas por sexo
data %>% spread(Grupo, Total, fill = NA, convert = FALSE) %>% mutate(tasa_hombres = c(log(Hombres[2:length(Hombres)]/Hombres[1:length(Hombres)-1]),1))%>% mutate(tasa_mujeres = c(log(Mujeres[2:length(Mujeres)]/Mujeres[1:length(Mujeres)-1]),1))%>% mutate(Fecha=as.Date(paste("01","06",Año,sep="/"),"%d/%m/%Y"))   -> data2
data2 %>% ggplot()+geom_line(aes(x=Año,y=Hombres,color="Hombres"))+geom_line(aes(x=Año,y=Mujeres,color="Mujeres")) + ylim(0,27000000) -> grafica2
ggplotly (grafica2)
# Proyectar población a nivel mensual
ts_pob_nal_hom <- zoo(data2$Hombres,data2$Fecha)
ts_pob_nal_hom_mon <- na.spline(ts_pob_nal_hom, xout = seq(start(ts_pob_nal_hom),as.Date(as.yearqtr(end(ts_pob_nal_hom))+ 3/4) , by = "month"), method = "hyman")
ts_pob_nal_muj <- zoo(data2$Mujeres,data2$Fecha)
ts_pob_nal_muj_mon <- na.spline(ts_pob_nal_muj, xout = seq(start(ts_pob_nal_muj),as.Date(as.yearqtr(end(ts_pob_nal_muj))+ 3/4) , by = "month"), method = "fmm")
pob_nal_est = cbind(seq(as.Date("1985/6/1"), as.Date("2021/1/1"), "months"), as.data.frame.ts(ts_pob_nal_hom_mon),as.data.frame.ts(ts_pob_nal_muj_mon))
colnames(pob_nal_est) <- c("Fecha","Hombres","Mujeres")
pob_nal_est %>% ggplot()+geom_line(aes(x=Fecha,y=Hombres,color="Hombres"))+geom_line(aes(x=Fecha,y=Mujeres,color="Mujeres")) + ylim(0,27000000) -> grafica3
ggplotly (grafica3)
# Chunk 6
tasa_ingreso <- 300/1000000
tasa_juicio <- 0.05
prob_condena <- 0.7
pob_car_ini <- 32026
tasa_salida <-0.04
pob_nal_est %>% filter(Fecha >= as.Date("1991/01/01"),Fecha <= as.Date("2015/09/01")) -> pob_nal_est_91
for (i in 1:length(seq(as.Date("1985/6/1"), as.Date("2021/1/1"), "months"))) {
pob_nal_est_91
next
}
pob_sin[1] <- pob_sin_ini
pob_con[1] <- pob_con_ini
tasa_ingreso <- 300/1000000
tasa_juicio <- 0.05
prob_condena <- 0.7
pob_sin_ini <- 16277
pob_con_ini <- 15799
tasa_salida <-0.04
pob_sin[1] <- pob_sin_ini
pob_con[1] <- pob_con_ini
u1 <- rnorm(30) # create a vector filled with random normal values
print("This loop calculates the square of the first 10 elements of vector u1")
usq<-0
for(i in 1:10)
{
usq[i]<-u1[i]*u1[i] # i-th element of u1 squared into i-th position of usq
print(usq[i])
}
print(i)
usq
pob_sin <- pob_sin_ini
pob_con <- pob_con_ini
pob_sin[1]
pob_nal_est %>% filter(Fecha >= as.Date("1991/01/01"),Fecha <= as.Date("2015/09/01")) -> pob_nal_est_91
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2021/8/1"), "months"))) {
pob_sin[i] <- pob_sin(i-1) +  pob_nal_est_91[i]*tasa_ingreso
next
}
pob_nal_est %>% filter(Fecha >= as.Date("1991/01/01"),Fecha <= as.Date("2015/09/01")) -> pob_nal_est_91
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2021/8/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  pob_nal_est_91[i]*tasa_ingreso
next
}
pob_nal_est %>% filter(Fecha >= as.Date("1991/01/01"),Fecha <= as.Date("2015/09/01")) -> pob_nal_est_91
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2021/8/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres)*tasa_ingreso
next
}
pob_sin
pob_sin <- pob_sin_ini
pob_con <- pob_con_ini
pob_nal_est %>% filter(Fecha >= as.Date("1991/01/01"),Fecha <= as.Date("2015/09/01")) -> pob_nal_est_91
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2015/9/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres)*tasa_ingreso
next
}
pob_sin
cbind(pob_nal_est_91,pob_sin)
head(cbind(pob_nal_est_91,pob_sin))
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2015/9/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres)*tasa_ingreso - pob_sin[i-1]*tasa_juicio
pob_con[i] <- pob_con[i-1] + pob_sin[i-1]*tasa_juicio*prob_condena - pob_con[i-1]*tasa_salida
next
}
head(cbind(pob_nal_est_91,pob_sin,pob_con))
tasa_ingreso <- 150/1000000
pob_nal_est %>% filter(Fecha >= as.Date("1991/01/01"),Fecha <= as.Date("2015/09/01")) -> pob_nal_est_91
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2015/9/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres)*tasa_ingreso - pob_sin[i-1]*tasa_juicio
pob_con[i] <- pob_con[i-1] + pob_sin[i-1]*tasa_juicio*prob_condena - pob_con[i-1]*tasa_salida
next
}
head(cbind(pob_nal_est_91,pob_sin,pob_con))
tasa_ingreso <- 100/1000000
pob_nal_est %>% filter(Fecha >= as.Date("1991/01/01"),Fecha <= as.Date("2015/09/01")) -> pob_nal_est_91
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2015/9/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres)*tasa_ingreso - pob_sin[i-1]*tasa_juicio
pob_con[i] <- pob_con[i-1] + pob_sin[i-1]*tasa_juicio*prob_condena - pob_con[i-1]*tasa_salida
next
}
head(cbind(pob_nal_est_91,pob_sin,pob_con))
tasa_juicio <- 0.1
pob_nal_est %>% filter(Fecha >= as.Date("1991/01/01"),Fecha <= as.Date("2015/09/01")) -> pob_nal_est_91
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2015/9/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres)*tasa_ingreso - pob_sin[i-1]*tasa_juicio
pob_con[i] <- pob_con[i-1] + pob_sin[i-1]*tasa_juicio*prob_condena - pob_con[i-1]*tasa_salida
next
}
head(cbind(pob_nal_est_91,pob_sin,pob_con))
tasa_ingreso <- 5/100000
tasa_juicio <- 0.1
prob_condena <- 0.7
pob_sin_ini <- 16277
pob_con_ini <- 15799
tasa_salida <-0.04
pob_nal_est %>% filter(Fecha >= as.Date("1991/01/01"),Fecha <= as.Date("2015/09/01")) -> pob_nal_est_91
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2015/9/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres)*tasa_ingreso - pob_sin[i-1]*tasa_juicio
pob_con[i] <- pob_con[i-1] + pob_sin[i-1]*tasa_juicio*prob_condena - pob_con[i-1]*tasa_salida
next
}
head(cbind(pob_nal_est_91,pob_sin,pob_con))
tasa_ingreso <- 5/100000
tasa_juicio <- 0.2
prob_condena <- 0.6
pob_sin_ini <- 16277
pob_con_ini <- 15799
tasa_salida <-0.05
pob_sin <- pob_sin_ini
pob_con <- pob_con_ini
pob_nal_est %>% filter(Fecha >= as.Date("1991/01/01"),Fecha <= as.Date("2015/09/01")) -> pob_nal_est_91
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2015/9/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres)*tasa_ingreso - pob_sin[i-1]*tasa_juicio
pob_con[i] <- pob_con[i-1] + pob_sin[i-1]*tasa_juicio*prob_condena - pob_con[i-1]*tasa_salida
next
}
head(cbind(pob_nal_est_91,pob_sin,pob_con))
tasa_ingreso <- 5/100000
tasa_juicio <- 0.1
prob_condena <- 0.6
pob_sin_ini <- 16277
pob_con_ini <- 15799
tasa_salida <-0.05
pob_sin <- pob_sin_ini
pob_con <- pob_con_ini
pob_nal_est %>% filter(Fecha >= as.Date("1991/01/01"),Fecha <= as.Date("2015/09/01")) -> pob_nal_est_91
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2015/9/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres)*tasa_ingreso - pob_sin[i-1]*tasa_juicio
pob_con[i] <- pob_con[i-1] + pob_sin[i-1]*tasa_juicio*prob_condena - pob_con[i-1]*tasa_salida
next
}
head(cbind(pob_nal_est_91,pob_sin,pob_con))
```
```{r prueba loops}
u1 <- rnorm(30) # create a vector filled with random normal values
print("This loop calculates the square of the first 10 elements of vector u1")
usq<-0
for(i in 1:10)
{
usq[i]<-u1[i]*u1[i] # i-th element of u1 squared into i-th position of usq
print(usq[i])
}
print(i)
pob_est_91<-(cbind(pob_nal_est_91,pob_sin,pob_con))
pob_est_91<-(cbind(pob_nal_est_91,pob_sin,pob_con))
pob_est_91
pob_est_91<- mutate((cbind(pob_sin,pob_con)
)
)
pob_est_91 %>% mutate(pob_sin,pob_con)
tasa_ingreso <- 5/100000
tasa_juicio <- 0.1
prob_condena <- 0.6
pob_sin_ini <- 16277
pob_con_ini <- 15799
tasa_salida <-0.05
pob_sin <- pob_sin_ini
pob_con <- pob_con_ini
pob_nal_est %>% filter(Fecha >= as.Date("1991/01/01"),Fecha <= as.Date("2015/09/01")) -> pob_nal_est_91
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2015/9/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres)*tasa_ingreso - pob_sin[i-1]*tasa_juicio
pob_con[i] <- pob_con[i-1] + pob_sin[i-1]*tasa_juicio*prob_condena - pob_con[i-1]*tasa_salida
next
}
pob_est_91 %>% mutate(pob_sin,pob_con)
pob_est_91
pob_est_91 %>% mutate(pob_sin,pob_con) %>% mutate((pob_pob_sin+pob_con)/(pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres))
pob_est_91 %>% mutate(pob_sin,pob_con) %>% mutate((pob_sin+pob_con)/(pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres))
clear()
pob_est_91 %>% mutate(pob_sin,pob_con) %>% mutate(tasa_carcel = (pob_sin+pob_con)/(pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres))
head(pob_est_91)
pob_est_91 %<>% mutate(pob_sin,pob_con) %>% mutate(tasa_carcel = (pob_sin+pob_con)/(pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres))
head(pob_est_91)
pob_est_91 %<>% mutate(pob_sin,pob_con) %>% mutate(tasa_carcel = (pob_sin+pob_con)/(pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres)*100000)
head(pob_est_91)
tail(pob_est_91)
pob_est_91 %<>% mutate(pob_sin,pob_con) %>% mutate(tasa_carcel = (pob_sin+pob_con)/(Hombres+Mujeres)*100000)
pob_est_91 %<>% mutate(pob_sin,pob_con)
pob_est_91 %<>% mutate(pob_sin,pob_con)
pob_est_91
pob_est_91 %<>% mutate(pob_sin,pob_con) %>% mutate(tasa_carcel = (pob_sin+pob_con)/(Hombres+Mujeres)*100000)
pob_nal_est_91 %<>% mutate(pob_sin,pob_con) %>% mutate(tasa_carcel = (pob_sin+pob_con)/(Hombres+Mujeres)*100000)
pob_nal_est_91 %<>% mutate(pob_sin,pob_con)
pob_nal_est_91 %<>% mutate(pob_sin,pob_con) %>% mutate(tasa_carcel = ((pob_sin+pob_con)/(Hombres+Mujeres))*100000)
pob_nal_est_91 %<>% mutate(pob_sin,pob_con) %>% mutate(((pob_sin+pob_con)/(Hombres+Mujeres))*100000)
Head(pob_nal_est_91)
head(pob_nal_est_91)
pob_nal_est_91 %<>% mutate(pob_sin,pob_con) %>% mutate((pob_sin+pob_con)/(Hombres+Mujeres)*100000)
pob_nal_est_91 %<>% mutate(pob_sin,pob_con) %>% mutate (pop_total = Hombres + Mujeres)
pob_nal_est_91 %<>% mutate(pob_sin,pob_con) %>% mutate (pop_total = Hombres)
pob_nal_est_91 %<>% mutate(pob_sin,pob_con) %>% mutate (pop_total = Hombres %+% Mujeres)
pob_nal_est %>% filter(Fecha >= as.Date("1991/01/01"),Fecha <= as.Date("2015/09/01")) -> pob_nal_est_91
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2015/9/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres[i])*tasa_ingreso - pob_sin[i-1]*tasa_juicio
pob_con[i] <- pob_con[i-1] + pob_sin[i-1]*tasa_juicio*prob_condena - pob_con[i-1]*tasa_salida
head(pob_nal_est_91)
head(pob_nal_est_91)
pob_total <- 17040712 + 17500016
pob_sin <- pob_sin_ini
pob_con <- pob_con_ini
pob_total <- 17040712 + 17500016
pob_nal_est %>% filter(Fecha >= as.Date("1991/01/01"),Fecha <= as.Date("2015/09/01")) -> pob_nal_est_91
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2015/9/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres[i])*tasa_ingreso - pob_sin[i-1]*tasa_juicio
pob_con[i] <- pob_con[i-1] + pob_sin[i-1]*tasa_juicio*prob_condena - pob_con[i-1]*tasa_salida
pob_total[i] = pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres[i]
next
}
pob_nal_est_91 %<>% mutate(pob_sin,pob_con,pop_total)
head(pob_nal_est_91)
pob_nal_est %>% filter(Fecha >= as.Date("1991/01/01"),Fecha <= as.Date("2015/09/01")) -> pob_nal_est_91
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2015/9/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres[i])*tasa_ingreso - pob_sin[i-1]*tasa_juicio
pob_con[i] <- pob_con[i-1] + pob_sin[i-1]*tasa_juicio*prob_condena - pob_con[i-1]*tasa_salida
pob_total[i] <- pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres[i]
next
}
pob_nal_est_91 %<>% mutate(pob_sin,pob_con,pop_total)
head(pob_nal_est_91)
pop_total
pob_total <- 17040712 + 17500016
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2015/9/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres[i])*tasa_ingreso - pob_sin[i-1]*tasa_juicio
pob_con[i] <- pob_con[i-1] + pob_sin[i-1]*tasa_juicio*prob_condena - pob_con[i-1]*tasa_salida
pob_total[i] <- pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres[i]
next
}
pop_total
pop_con
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2015/9/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres[i])*tasa_ingreso - pob_sin[i-1]*tasa_juicio
pob_con[i] <- pob_con[i-1] + pob_sin[i-1]*tasa_juicio*prob_condena - pob_con[i-1]*tasa_salida
pob_total[i] <- pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres[i]
print(pob_sin[i])
next
}
pop_sin
pop_sin[1]
print(pob_sin[i])
print[i]
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2015/9/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres[i])*tasa_ingreso - pob_sin[i-1]*tasa_juicio
pob_con[i] <- pob_con[i-1] + pob_sin[i-1]*tasa_juicio*prob_condena - pob_con[i-1]*tasa_salida
pob_total[i] <- pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres[i]
print(pob_sin[i])
print[i]
next
}
print(i)
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2015/9/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres[i])*tasa_ingreso - pob_sin[i-1]*tasa_juicio
pob_con[i] <- pob_con[i-1] + pob_sin[i-1]*tasa_juicio*prob_condena - pob_con[i-1]*tasa_salida
pob_total[i] <- pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres[i]
print(pob_sin[i])
print(i)
next
}
pop_sin[1]
pob_sin
pob_nal_est_91 %<>% mutate(pob_sin,pob_con,pob_total)
head(pob_nal_est_91)
pob_nal_est_91 %<>% mutate(pob_sin,pob_con,pob_total) %>% mutate(tasa = (pob_sin+pob_con)/pob_total)
head(pob_nal_est_91)
pob_nal_est_91 %<>% mutate(pob_sin,pob_con,pob_total) %>% mutate(tasa = (pob_sin+pob_con)/pob_total)*100000
pob_nal_est_91 %<>% mutate(pob_sin,pob_con,pob_total) %>% mutate(tasa = (pob_sin+pob_con)/pob_total*100000)
head(pob_nal_est_91)
tasa_ingreso <- 5/100000
tasa_juicio <- 0.1
prob_condena <- 0.6
pob_sin_ini <- 16277
pob_con_ini <- 15799
tasa_salida <-0.05
pob_sin <- pob_sin_ini
pob_con <- pob_con_ini
pob_total <- 17040712 + 17500016
pob_nal_est %>% filter(Fecha >= as.Date("1991/01/01"),Fecha <= as.Date("2015/09/01")) -> pob_nal_est_91
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2015/9/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres[i])*tasa_ingreso - pob_sin[i-1]*tasa_juicio
pob_con[i] <- pob_con[i-1] + pob_sin[i-1]*tasa_juicio*prob_condena - pob_con[i-1]*tasa_salida
pob_total[i] <- pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres[i]
print(pob_sin[i])
print(i)
next
}
pop_total
pob_sin
pob_nal_est_91 %<>% mutate(pob_sin,pob_con,pob_total) %>% mutate(tasa = (pob_sin+pob_con)/pob_total*100000)
head(pob_nal_est_91)
pob_nal_est_91 %>% geom_line(aes(x=Fecha,y=pob_sin,color="sindicados"))+geom_line(aes(x=Fecha,y=pob_con,color="Condenados"))
ggplot()+geom_line(aes(x=Fecha,y=pob_sin,color=""))+geom_line(aes(x=Fecha,y=pob_con,color="Condenados"))
pob_nal_est_91
head(pob_nal_est_91)
pob_nal_est_91 %>% ggplot()+geom_line(aes(x=Fecha,y=pob_sin,color=""))+geom_line(aes(x=Fecha,y=pob_con,color="Condenados"))
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa)
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo = pob_con,Grupo = pob_sin)
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo = "pob_con",Grupo = "pob_sin")
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo == "pob_con",Grupo == "pob_sin")
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo == pob_con,Grupo == pob_sin)
pob_nal_est_91 %>% head(gather(Grupo, Valor, Hombres:tasa))
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa)
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) -> gato
head(gato)
gato %>% filte(Grupo=Hombres)
gato %>% filer(Grupo=Hombres)
gato %>% filter(Grupo=Hombres)
gato %>% filter(Grupo==Hombres)
gato %>% filter(Grupo=="Hombres")
gato %>% filter(Grupo=="Hombres"|Grupo=="Mujeres")
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo=="Hombres"|Grupo=="Mujeres")
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo=="pob_con"|Grupo=="pob_sin")
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo=="pob_con"|Grupo=="pob_sin") %>% ggplot()+ barplot(aes(x=Fecha,y=Valor, fill=Grupo))
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo=="pob_con"|Grupo=="pob_sin") %>% ggplot()+ barplot(aes(x=Fecha,height=Valor, fill=Grupo))
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo=="pob_con"|Grupo=="pob_sin") %>% ggplot()+ geom_bar(aes(x=Fecha,height=Valor, fill=Grupo))
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo=="pob_con"|Grupo=="pob_sin") %>% ggplot()+ geom_bar(aes(x=Fecha,height=Valor, fill=Grupo,stat='identity'))
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo=="pob_con"|Grupo=="pob_sin") %>% ggplot()+ geom_bar(aes(x=Fecha,height=Valor, fill=Grupo,stat='sum'))
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo=="pob_con"|Grupo=="pob_sin") %>% ggplot()+ geom_bar(aes(x=Fecha,height=Valor, fill=Grupo),stat='identity')
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo=="pob_con"|Grupo=="pob_sin") %>% ggplot(aes(x=Fecha,height=Valor, fill=Grupo))+ geom_bar(stat='identity')
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo=="pob_con"|Grupo=="pob_sin")
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo=="pob_con"|Grupo=="pob_sin") %>% ggplot(aes(x=Fecha,height=Valor, fill=Grupo))+ geom_bar()
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo=="pob_con"|Grupo=="pob_sin") %>% ggplot(aes(x=Fecha,y=Valor, fill=Grupo))+ geom_bar(stat = 'identity')
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo=="pob_con"|Grupo=="pob_sin") %>% ggplot()+ geom_bar(stat = 'identity',aes(x=Fecha,y=Valor, fill=Grupo))
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo=="pob_con"|Grupo=="pob_sin") %>% ggplot()+ geom_bar(stat = 'identity',aes(x=Fecha,y=Valor, fill=Grupo)) %>% gra_pob_car
ggplotly(gra_pob_car)
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo=="pob_con"|Grupo=="pob_sin") %>% ggplot()+ geom_bar(stat = 'identity',aes(x=Fecha,y=Valor, fill=Grupo)) <- gra_pob_car
ggplotly(gra_pob_car)
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo=="pob_con"|Grupo=="pob_sin") %>% ggplot()+ geom_bar(stat = 'identity',aes(x=Fecha,y=Valor, fill=Grupo)) -> gra_pob_car
ggplotly(gra_pob_car)
View(pob_est_91)
pob_nal_est_91 %>% ggplot()+geom_line(aes(x=Fecha,y=tasa_carcel))
pob_nal_est_91 %>% ggplot()+geom_line(aes(x=Fecha,y=tasa_carcel))
head(pob_nal_est_91)
pob_nal_est_91 %>% ggplot()+geom_line(aes(x=Fecha,y=tasa))
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo=="pob_con"|Grupo=="pob_sin") %>% ggplot()+ geom_bar(stat = 'identity',aes(x=Fecha,y=Valor, fill=Grupo))-> gra_pob_car
ggplotly(gra_pob_car)
pob_nal_est_91 %>% ggplot()+geom_line(aes(x=Fecha,y=tasa)) <- gra_tasa
ggplotly(gra_tasa)
pob_nal_est_91 %>% ggplot()+geom_line(aes(x=Fecha,y=tasa)) -> gra_tasa
ggplotly(gra_tasa)
```{r Proyección tasas}
tasa_ingreso <- 5/100000
tasa_juicio <- 0.1
prob_condena <- 0.6
pob_sin_ini <- 16277
pob_con_ini <- 15799
tasa_salida <-0.05
pob_sin <- pob_sin_ini
pob_con <- pob_con_ini
pob_total <- 17040712 + 17500016
pob_nal_est %>% filter(Fecha >= as.Date("1991/01/01"),Fecha <= as.Date("2015/09/01")) -> pob_nal_est_91
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2015/9/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres[i])*tasa_ingreso - pob_sin[i-1]*tasa_juicio
pob_con[i] <- pob_con[i-1] + pob_sin[i-1]*tasa_juicio*prob_condena - pob_con[i-1]*tasa_salida
pob_total[i] <- pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres[i]
next
}
pob_nal_est_91 %<>% mutate(pob_sin,pob_con,pob_total) %>% mutate(tasa = (pob_sin+pob_con)/pob_total*100000)
head(pob_nal_est_91)
pob_nal_est_91 %>% ggplot()+geom_line(aes(x=Fecha,y=pob_sin,color=""))+geom_line(aes(x=Fecha,y=pob_con,color="Condenados"))
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo=="pob_con"|Grupo=="pob_sin") %>% ggplot()+ geom_bar(stat = 'identity',aes(x=Fecha,y=Valor, fill=Grupo))-> gra_pob_car
ggplotly(gra_pob_car)
pob_nal_est_91 %>% ggplot()+geom_line(aes(x=Fecha,y=tasa)) -> gra_tasa
ggplotly(gra_tasa)
```
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2: cars
summary(cars)
# Chunk 3: pressure
plot(pressure)
# Chunk 4: librerías
library("magrittr")
library("dplyr")
library("tidyr")
library("ggplot2")
library("plotly")
library("zoo")
# Chunk 5: Estimación Población Nacional
setwd("/home/sergio/Prisiones/Data")
data = read.csv("POB_NAL_DANE.csv",header = TRUE,sep = ",",stringsAsFactors=FALSE)
# Graficar proyección de población
data %>% ggplot()+geom_line(aes(x=Año,y=Total, col = Grupo)) + ylim(0,27000000) -> grafica1
ggplotly(grafica1)
# reordenar columnas por sexo
data %>% spread(Grupo, Total, fill = NA, convert = FALSE) %>% mutate(tasa_hombres = c(log(Hombres[2:length(Hombres)]/Hombres[1:length(Hombres)-1]),1))%>% mutate(tasa_mujeres = c(log(Mujeres[2:length(Mujeres)]/Mujeres[1:length(Mujeres)-1]),1))%>% mutate(Fecha=as.Date(paste("01","06",Año,sep="/"),"%d/%m/%Y"))   -> data2
data2 %>% ggplot()+geom_line(aes(x=Año,y=Hombres,color="Hombres"))+geom_line(aes(x=Año,y=Mujeres,color="Mujeres")) + ylim(0,27000000) -> grafica2
ggplotly (grafica2)
# Proyectar población a nivel mensual
ts_pob_nal_hom <- zoo(data2$Hombres,data2$Fecha)
ts_pob_nal_hom_mon <- na.spline(ts_pob_nal_hom, xout = seq(start(ts_pob_nal_hom),as.Date(as.yearqtr(end(ts_pob_nal_hom))+ 3/4) , by = "month"), method = "hyman")
ts_pob_nal_muj <- zoo(data2$Mujeres,data2$Fecha)
ts_pob_nal_muj_mon <- na.spline(ts_pob_nal_muj, xout = seq(start(ts_pob_nal_muj),as.Date(as.yearqtr(end(ts_pob_nal_muj))+ 3/4) , by = "month"), method = "fmm")
pob_nal_est = cbind(seq(as.Date("1985/6/1"), as.Date("2021/1/1"), "months"), as.data.frame.ts(ts_pob_nal_hom_mon),as.data.frame.ts(ts_pob_nal_muj_mon))
colnames(pob_nal_est) <- c("Fecha","Hombres","Mujeres")
pob_nal_est %>% ggplot()+geom_line(aes(x=Fecha,y=Hombres,color="Hombres"))+geom_line(aes(x=Fecha,y=Mujeres,color="Mujeres")) + ylim(0,27000000) -> grafica3
ggplotly (grafica3)
# Chunk 6: Proyección_tasas
tasa_ingreso <- 5/100000
tasa_juicio <- 0.1
prob_condena <- 0.6
pob_sin_ini <- 16277
pob_con_ini <- 15799
tasa_salida <-0.05
pob_sin <- pob_sin_ini
pob_con <- pob_con_ini
pob_total <- 17040712 + 17500016
pob_nal_est %>% filter(Fecha >= as.Date("1991/01/01"),Fecha <= as.Date("2015/09/01")) -> pob_nal_est_91
for (i in 2:length(seq(as.Date("1991/1/1"), as.Date("2015/9/1"), "months"))) {
pob_sin[i] <- pob_sin[i-1] +  (pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres[i])*tasa_ingreso - pob_sin[i-1]*tasa_juicio
pob_con[i] <- pob_con[i-1] + pob_sin[i-1]*tasa_juicio*prob_condena - pob_con[i-1]*tasa_salida
pob_total[i] <- pob_nal_est_91$Hombres[i]+pob_nal_est_91$Mujeres[i]
next
}
pob_nal_est_91 %<>% mutate(pob_sin,pob_con,pob_total) %>% mutate(tasa = (pob_sin+pob_con)/pob_total*100000)
head(pob_nal_est_91)
pob_nal_est_91 %>% ggplot()+geom_line(aes(x=Fecha,y=pob_sin,color=""))+geom_line(aes(x=Fecha,y=pob_con,color="Condenados"))
pob_nal_est_91 %>% gather(Grupo, Valor, Hombres:tasa) %>% filter(Grupo=="pob_con"|Grupo=="pob_sin") %>% ggplot()+ geom_bar(stat = 'identity',aes(x=Fecha,y=Valor, fill=Grupo))-> gra_pob_car
ggplotly(gra_pob_car)
pob_nal_est_91 %>% ggplot()+geom_line(aes(x=Fecha,y=tasa)) -> gra_tasa
ggplotly(gra_tasa)
# Chunk 7
ggplotly(gra_pob_car)
ggplotly(gra_tasa)
ggplotly(gra_pob_car)
ggplotly(gra_tasa)
library("shiny")
library("gato")
library("magrittr")
library("dplyr")
library("tidyr")
library("ggplot2")
library("plotly")
library("zoo")
library("shiny")
pob_sin <- input$pob_sin_ini
pob_con <- input$pob_con_ini
pob_total <- 17040712 + 17500016
